# Amortized Capture Probability Configuration
#
# This preset enables amortized inference for capture probability (p_capture
# or phi_capture for mean_odds parameterization) in VCP models.
#
# Usage:
#   python infer.py model=nbvcp amortization=capture
#   python infer.py +amortization=capture
#
# The MLP architecture (constrained mode):
#   log(1 + total_counts) → [Linear → act] × 2 → output_heads → transform → (α, β)
#
# Output: Beta(α, β) prior/posterior for p_capture, or BetaPrime(α, β) for phi_capture

# Enable amortized inference
enabled: true

# Hidden layer dimensions (defines network depth and width)
# Default: 2 layers with 64 and 32 units
# Larger: [128, 64, 32] for more complex relationships
# Smaller: [32, 16] for faster training
hidden_dims: [64, 32]

# Activation function for hidden layers
# Options: relu, gelu, silu, tanh, sigmoid, elu, leaky_relu, softplus
activation: leaky_relu

# Transform for positive output parameters (alpha, beta) in constrained mode.
# "softplus": softplus(x) + 0.5 — numerically stable, grows linearly (default)
# "exp": exponential — original behavior, can produce extreme values
output_transform: softplus

# Clamp range for positive outputs in constrained mode.
# Prevents extreme BetaPrime/Beta shape parameters that cause NaN.
# Set to null to disable either bound.
output_clamp_min: 0.1
output_clamp_max: 50.0
