# @package _global_

# Plotting options
viz:
  # Path to the hydra run directory containing the inference results
  # Set to ??? to auto-detect based on data/inference config
  run_dir: ???
  loss: true
  ecdf: false
  ppc: false
  umap: false  # Disabled by default (can be slow for large datasets)
  heatmap: false  # Disabled by default (requires posterior sampling which can be slow)
  mixture_ppc: false  # Only runs when mixture_model=true, shows genes differing between components
  annotation_ppc: false  # Only runs when annotation_key is set; per-annotation component PPC
  format: png  # Output format: png, pdf, svg, eps

  # ECDF plot options
  ecdf_opts:
    n_genes: 25

  # PPC plot options
  ppc_opts:
    n_rows: 5  # Number of expression bins (logarithmically spaced)
    n_cols: 5  # Number of genes per bin
    n_samples: 1500
  
  # UMAP plot options
  umap_opts:
    n_neighbors: 15  # Number of neighbors for UMAP
    min_dist: 0.1  # Minimum distance for UMAP
    n_components: 2  # Number of UMAP dimensions
    random_state: 42  # Random seed for reproducibility
    target_sum: 1e4  # Library-size normalization target (counts per cell)
    gene_filter_min_cells: 3  # Keep genes detected in at least this many cells
    use_hvg: true  # Select highly variable genes before UMAP
    hvg_n_top_genes: 2000  # Number of HVGs (Scanpy-style default)
    hvg_flavor: "seurat"  # Scanpy HVG flavor
    use_pca: true  # Run PCA before UMAP (standard Scanpy workflow)
    pca_n_comps: 50  # Number of PCs used as UMAP input
    batch_size: 1000  # Batch size for PPC sampling (None = no batching, use for memory efficiency)
    data_color: "dark_blue"  # Color for experimental data
    synthetic_color: "dark_red"  # Color for synthetic data
    cache_umap: true  # Cache fitted UMAP in data directory (avoids re-fitting for same data)

  # Correlation heatmap options
  heatmap_opts:
    n_genes: 200  # Number of genes to display (selected by correlation variance)
    n_samples: 512 # Number of posterior samples to generate for correlation computation
    figsize: 12  # Figure size (square)
    cmap: "RdBu_r"  # Colormap (red=positive, blue=negative correlation)

  # Mixture model PPC options (genes with highest CV across components)
  mixture_ppc_opts:
    n_rows: 5  # Number of rows in the grid
    n_cols: 5  # Number of columns in the grid
    n_samples: 1500  # Number of PPC samples per component

  # Annotation PPC options (per-annotation component PPC)
  annotation_ppc_opts:
    n_rows: 5  # Number of expression bins
    n_cols: 5  # Number of genes per bin
    n_samples: 1500  # Number of PPC samples per annotation
