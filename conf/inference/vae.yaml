# @package inference
# Variational Autoencoder configuration
# VAE uses SVI internally for optimization.
# Inherits n_steps, batch_size, stable_update, early_stopping from svi.

defaults:
  - svi

method: vae

# VAE architecture
vae_latent_dim: 10
vae_encoder_hidden_dims: [256, 128, 64]
vae_decoder_hidden_dims: [64, 128, 256]
vae_activation: leaky_relu
vae_input_transform: log1p
vae_standardize: false

# Decoder output transforms (optional per-param overrides)
# Default: softplus for positive params, sigmoid for bounded params
# Override with: vae_decoder_transforms.r=exp
vae_decoder_transforms: null

# Flow prior (on by default â€” spline coupling is most expressive)
vae_flow_type: coupling_spline  # none, coupling_affine, coupling_spline, maf, iaf
vae_flow_num_layers: 4
vae_flow_hidden_dims: [64, 64]
