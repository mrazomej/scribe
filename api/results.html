

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>results &mdash; SCRIBE  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sampling" href="sampling.html" />
    <link rel="prev" title="svi" href="svi.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SCRIBE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickoverview.html">Quick Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Available Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../results.html">Results Class</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="models.html">models</a></li>
<li class="toctree-l2"><a class="reference internal" href="models_mix.html">models_mix</a></li>
<li class="toctree-l2"><a class="reference internal" href="svi.html">svi</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scribe.results.ScribeResults"><code class="docutils literal notranslate"><span class="pre">ScribeResults</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.params"><code class="docutils literal notranslate"><span class="pre">ScribeResults.params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.loss_history"><code class="docutils literal notranslate"><span class="pre">ScribeResults.loss_history</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.n_cells"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_cells</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.n_genes"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_genes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.model_type"><code class="docutils literal notranslate"><span class="pre">ScribeResults.model_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.model_config"><code class="docutils literal notranslate"><span class="pre">ScribeResults.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.prior_params"><code class="docutils literal notranslate"><span class="pre">ScribeResults.prior_params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.obs"><code class="docutils literal notranslate"><span class="pre">ScribeResults.obs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.var"><code class="docutils literal notranslate"><span class="pre">ScribeResults.var</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.uns"><code class="docutils literal notranslate"><span class="pre">ScribeResults.uns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.n_obs"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_obs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.n_vars"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.posterior_samples"><code class="docutils literal notranslate"><span class="pre">ScribeResults.posterior_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.predictive_samples"><code class="docutils literal notranslate"><span class="pre">ScribeResults.predictive_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.n_components"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_components</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">ScribeResults.params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">ScribeResults.loss_history</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_cells</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_genes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">ScribeResults.model_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">ScribeResults.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">ScribeResults.prior_params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">ScribeResults.obs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">ScribeResults.var</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">ScribeResults.uns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_obs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">ScribeResults.posterior_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">ScribeResults.predictive_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">ScribeResults.n_components</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.__post_init__"><code class="docutils literal notranslate"><span class="pre">ScribeResults.__post_init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.from_anndata"><code class="docutils literal notranslate"><span class="pre">ScribeResults.from_anndata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.get_distributions"><code class="docutils literal notranslate"><span class="pre">ScribeResults.get_distributions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.get_map"><code class="docutils literal notranslate"><span class="pre">ScribeResults.get_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.__getitem__"><code class="docutils literal notranslate"><span class="pre">ScribeResults.__getitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.get_component"><code class="docutils literal notranslate"><span class="pre">ScribeResults.get_component()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.get_posterior_samples"><code class="docutils literal notranslate"><span class="pre">ScribeResults.get_posterior_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.get_predictive_samples"><code class="docutils literal notranslate"><span class="pre">ScribeResults.get_predictive_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.get_ppc_samples"><code class="docutils literal notranslate"><span class="pre">ScribeResults.get_ppc_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.log_likelihood"><code class="docutils literal notranslate"><span class="pre">ScribeResults.log_likelihood()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.log_likelihood_map"><code class="docutils literal notranslate"><span class="pre">ScribeResults.log_likelihood_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.assignment_entropy"><code class="docutils literal notranslate"><span class="pre">ScribeResults.assignment_entropy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.assignment_entropy_map"><code class="docutils literal notranslate"><span class="pre">ScribeResults.assignment_entropy_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.hellinger_distance"><code class="docutils literal notranslate"><span class="pre">ScribeResults.hellinger_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.kl_divergence"><code class="docutils literal notranslate"><span class="pre">ScribeResults.kl_divergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.jensen_shannon_divergence"><code class="docutils literal notranslate"><span class="pre">ScribeResults.jensen_shannon_divergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.cell_type_assignments"><code class="docutils literal notranslate"><span class="pre">ScribeResults.cell_type_assignments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scribe.results.ScribeResults.cell_type_assignments_map"><code class="docutils literal notranslate"><span class="pre">ScribeResults.cell_type_assignments_map()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sampling.html">sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html">stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="viz.html">viz</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SCRIBE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">API Reference</a></li>
      <li class="breadcrumb-item active">results</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/results.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-scribe.results">
<span id="results"></span><h1>results<a class="headerlink" href="#module-scribe.results" title="Link to this heading"></a></h1>
<p>Results classes for SCRIBE inference.</p>
<dl class="py class">
<dt class="sig sig-object py" id="scribe.results.ScribeResults">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scribe.results.</span></span><span class="sig-name descname"><span class="pre">ScribeResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictive_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for SCRIBE inference results.</p>
<p>This class stores the results from SCRIBE’s variational inference procedure,
including model parameters, loss history, dataset dimensions, and model
configuration. It can optionally store metadata from an AnnData object and
posterior/predictive samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>)</p></li>
<li><p><strong>loss_history</strong> (<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>)</p></li>
<li><p><strong>n_cells</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>n_genes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>model_config</strong> (<em>ModelConfig</em>)</p></li>
<li><p><strong>prior_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>)</p></li>
<li><p><strong>obs</strong> (<em>DataFrame</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>var</strong> (<em>DataFrame</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>uns</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>n_obs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>n_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>posterior_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>predictive_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>n_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#scribe.results.ScribeResults.params" title="Link to this definition"></a></dt>
<dd><p>Dictionary of inferred model parameters from SCRIBE</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.loss_history">
<span class="sig-name descname"><span class="pre">loss_history</span></span><a class="headerlink" href="#scribe.results.ScribeResults.loss_history" title="Link to this definition"></a></dt>
<dd><p>Array containing the ELBO loss values during training</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.n_cells">
<span class="sig-name descname"><span class="pre">n_cells</span></span><a class="headerlink" href="#scribe.results.ScribeResults.n_cells" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.n_genes">
<span class="sig-name descname"><span class="pre">n_genes</span></span><a class="headerlink" href="#scribe.results.ScribeResults.n_genes" title="Link to this definition"></a></dt>
<dd><p>Number of genes in the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.model_type">
<span class="sig-name descname"><span class="pre">model_type</span></span><a class="headerlink" href="#scribe.results.ScribeResults.model_type" title="Link to this definition"></a></dt>
<dd><p>Type of model used for inference</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><a class="headerlink" href="#scribe.results.ScribeResults.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration object specifying model architecture and priors</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ModelConfig</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.prior_params">
<span class="sig-name descname"><span class="pre">prior_params</span></span><a class="headerlink" href="#scribe.results.ScribeResults.prior_params" title="Link to this definition"></a></dt>
<dd><p>Dictionary of prior parameter values used during inference</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.obs">
<span class="sig-name descname"><span class="pre">obs</span></span><a class="headerlink" href="#scribe.results.ScribeResults.obs" title="Link to this definition"></a></dt>
<dd><p>Cell-level metadata from adata.obs, if provided</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.var">
<span class="sig-name descname"><span class="pre">var</span></span><a class="headerlink" href="#scribe.results.ScribeResults.var" title="Link to this definition"></a></dt>
<dd><p>Gene-level metadata from adata.var, if provided</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.uns">
<span class="sig-name descname"><span class="pre">uns</span></span><a class="headerlink" href="#scribe.results.ScribeResults.uns" title="Link to this definition"></a></dt>
<dd><p>Unstructured metadata from adata.uns, if provided</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.n_obs">
<span class="sig-name descname"><span class="pre">n_obs</span></span><a class="headerlink" href="#scribe.results.ScribeResults.n_obs" title="Link to this definition"></a></dt>
<dd><p>Number of observations (cells), if provided</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.n_vars">
<span class="sig-name descname"><span class="pre">n_vars</span></span><a class="headerlink" href="#scribe.results.ScribeResults.n_vars" title="Link to this definition"></a></dt>
<dd><p>Number of variables (genes), if provided</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.posterior_samples">
<span class="sig-name descname"><span class="pre">posterior_samples</span></span><a class="headerlink" href="#scribe.results.ScribeResults.posterior_samples" title="Link to this definition"></a></dt>
<dd><p>Samples of parameters from the posterior distribution, if generated</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.predictive_samples">
<span class="sig-name descname"><span class="pre">predictive_samples</span></span><a class="headerlink" href="#scribe.results.ScribeResults.predictive_samples" title="Link to this definition"></a></dt>
<dd><p>Predictive samples generated from the model, if generated</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.n_components">
<span class="sig-name descname"><span class="pre">n_components</span></span><a class="headerlink" href="#scribe.results.ScribeResults.n_components" title="Link to this definition"></a></dt>
<dd><p>Number of mixture components, if using a mixture model</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">loss_history</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><span class="pre">Array</span></a></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">n_cells</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">n_genes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">model_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ModelConfig</span></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">prior_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">obs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">var</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">uns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">n_obs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">n_vars</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">posterior_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">predictive_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">n_components</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.__post_init__">
<span class="sig-name descname"><span class="pre">__post_init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.__post_init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.__post_init__" title="Link to this definition"></a></dt>
<dd><p>Validate model configuration and parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.from_anndata">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_anndata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.from_anndata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.from_anndata" title="Link to this definition"></a></dt>
<dd><p>Create ScribeResults from AnnData object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>)</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>)</p></li>
<li><p><strong>loss_history</strong> (<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>)</p></li>
<li><p><strong>model_config</strong> (<em>ModelConfig</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.get_distributions">
<span class="sig-name descname"><span class="pre">get_distributions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scipy'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.get_distributions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.get_distributions" title="Link to this definition"></a></dt>
<dd><p>Get the variational distributions for all parameters using model config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default=&quot;scipy&quot;</em>) – Statistical package to use for distributions. Must be one of:
- “scipy”: Returns scipy.stats distributions
- “numpyro”: Returns numpyro.distributions</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping parameter names to their distributions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.get_map">
<span class="sig-name descname"><span class="pre">get_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.get_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.get_map" title="Link to this definition"></a></dt>
<dd><p>Get the maximum a posteriori (MAP) estimates from the variational
posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, replaces undefined MAP values (NaN) with posterior means</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – If True, prints a warning if NaNs were replaced with means</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of MAP estimates for each parameter</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, jnp.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Enable indexing of ScribeResults object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.get_component">
<span class="sig-name descname"><span class="pre">get_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.get_component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.get_component" title="Link to this definition"></a></dt>
<dd><p>Create a view of the results selecting a specific mixture component.</p>
<p>This method returns a new ScribeResults object that contains parameter
values for the specified component, allowing for further gene-based
indexing. Only applicable to mixture models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>component_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the component to select</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new ScribeResults object with parameters for the selected component</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#scribe.results.ScribeResults" title="scribe.results.ScribeResults">ScribeResults</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the model is not a mixture model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.get_posterior_samples">
<span class="sig-name descname"><span class="pre">get_posterior_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Array([0,</span> <span class="pre">42],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.get_posterior_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.get_posterior_samples" title="Link to this definition"></a></dt>
<dd><p>Sample parameters from the variational posterior distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng_key</strong> (<em>PRNGKey</em>)</p></li>
<li><p><strong>n_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>store_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.get_predictive_samples">
<span class="sig-name descname"><span class="pre">get_predictive_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Array([0,</span> <span class="pre">42],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.get_predictive_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.get_predictive_samples" title="Link to this definition"></a></dt>
<dd><p>Generate predictive samples using posterior parameter samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng_key</strong> (<em>PRNGKey</em>)</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>store_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.get_ppc_samples">
<span class="sig-name descname"><span class="pre">get_ppc_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Array([0,</span> <span class="pre">42],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.get_ppc_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.get_ppc_samples" title="Link to this definition"></a></dt>
<dd><p>Generate posterior predictive check samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng_key</strong> (<em>PRNGKey</em>)</p></li>
<li><p><strong>n_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>store_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>resample_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_by='cell'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_axis=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_nans=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_components=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.log_likelihood" title="Link to this definition"></a></dt>
<dd><p>Compute log likelihood of data under posterior samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> (<em>jnp.ndarray</em>) – Count data to evaluate likelihood on</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>default=None</em>) – Size of mini-batches used for likelihood computation</p></li>
<li><p><strong>return_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default='cell'</em>) – <dl class="simple">
<dt>Specifies how to return the log probabilities. Must be one of:</dt><dd><ul>
<li><p>’cell’: returns log probabilities summed over genes</p></li>
<li><p>’gene’: returns log probabilities summed over cells</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>cells_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – Axis along which cells are arranged. 0 means cells are rows.</p></li>
<li><p><strong>ignore_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, removes any samples that contain NaNs.</p></li>
<li><p><strong>split_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, returns log likelihoods for each mixture component
separately. Only applicable for mixture models.</p></li>
<li><p><strong>weights</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em><em>, </em><em>default=None</em>) – Array used to weight the log likelihoods (for mixture models).</p></li>
<li><p><strong>weight_type</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>default=None</em>) – <dl class="simple">
<dt>How to apply weights. Must be one of:</dt><dd><ul>
<li><p>’multiplicative’: multiply log probabilities by weights</p></li>
<li><p>’additive’: add weights to log probabilities</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Array of log likelihoods. Shape depends on model type, return_by and
split_components parameters. For standard models:</p>
<blockquote>
<div><ul class="simple">
<li><p>’cell’: shape (n_samples, n_cells)</p></li>
<li><p>’gene’: shape (n_samples, n_genes)</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>For mixture models with split_components=False:</dt><dd><ul class="simple">
<li><p>’cell’: shape (n_samples, n_cells)</p></li>
<li><p>’gene’: shape (n_samples, n_genes)</p></li>
</ul>
</dd>
<dt>For mixture models with split_components=True:</dt><dd><ul class="simple">
<li><p>’cell’: shape (n_samples, n_cells, n_components)</p></li>
<li><p>’gene’: shape (n_samples, n_genes, n_components)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If posterior samples have not been generated yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.log_likelihood_map">
<span class="sig-name descname"><span class="pre">log_likelihood_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_by='cell'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_axis=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_components=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mean=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.log_likelihood_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.log_likelihood_map" title="Link to this definition"></a></dt>
<dd><p>Compute log likelihood of data using MAP parameter estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> (<em>jnp.ndarray</em>) – Count data to evaluate likelihood on</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>default=None</em>) – Size of mini-batches used for likelihood computation</p></li>
<li><p><strong>gene_batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>default=None</em>) – Size of mini-batches used for likelihood computation by gene</p></li>
<li><p><strong>return_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default='cell'</em>) – <dl class="simple">
<dt>Specifies how to return the log probabilities. Must be one of:</dt><dd><ul>
<li><p>’cell’: returns log probabilities summed over genes</p></li>
<li><p>’gene’: returns log probabilities summed over cells</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>cells_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – Axis along which cells are arranged. 0 means cells are rows.</p></li>
<li><p><strong>split_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, returns log likelihoods for each mixture component separately.
Only applicable for mixture models.</p></li>
<li><p><strong>weights</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em><em>, </em><em>default=None</em>) – Array used to weight the log likelihoods (for mixture models).</p></li>
<li><p><strong>weight_type</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>default=None</em>) – <dl class="simple">
<dt>How to apply weights. Must be one of:</dt><dd><ul>
<li><p>’multiplicative’: multiply log probabilities by weights</p></li>
<li><p>’additive’: add weights to log probabilities</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>use_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, replaces undefined MAP values (NaN) with posterior means</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – If True, prints a warning if NaNs were replaced with means</p></li>
<li><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Array of log likelihoods. Shape depends on model type, return_by and
split_components parameters.
For standard models:</p>
<blockquote>
<div><ul class="simple">
<li><p>’cell’: shape (n_cells,)</p></li>
<li><p>’gene’: shape (n_genes,)</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>For mixture models with split_components=False:</dt><dd><ul class="simple">
<li><p>’cell’: shape (n_cells,)</p></li>
<li><p>’gene’: shape (n_genes,)</p></li>
</ul>
</dd>
<dt>For mixture models with split_components=True:</dt><dd><ul class="simple">
<li><p>’cell’: shape (n_cells, n_components)</p></li>
<li><p>’gene’: shape (n_genes, n_components)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.assignment_entropy">
<span class="sig-name descname"><span class="pre">assignment_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_by='gene'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_axis=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_nans=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.assignment_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.assignment_entropy" title="Link to this definition"></a></dt>
<dd><p>Compute the entropy of component assignment probabilities for mixture
models.</p>
<p>This method calculates the entropy of the posterior component assignment
probabilities for each cell or gene, providing a measure of assignment
uncertainty. Higher entropy values indicate more uncertainty in the
component assignments, while lower values indicate more confident
assignments.</p>
<dl class="simple">
<dt>The entropy is calculated as:</dt><dd><p>H = -∑(p_i * log(p_i))</p>
</dd>
</dl>
<p>where p_i are the normalized probabilities for each component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> (<em>jnp.ndarray</em>) – Input count data to evaluate component assignments for. Shape should
be (n_cells, n_genes) if cells_axis=0, or (n_genes, n_cells) if
cells_axis=1.</p></li>
<li><p><strong>return_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default='cell'</em>) – <dl class="simple">
<dt>Specifies how to compute and return the entropy. Must be one of:</dt><dd><ul>
<li><p>’cell’: Compute entropy of component assignments for each cell</p></li>
<li><p>’gene’: Compute entropy of component assignments for each gene</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>default=None</em>) – If provided, processes the data in batches of this size to reduce
memory usage. Useful for large datasets.</p></li>
<li><p><strong>cells_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – <dl class="simple">
<dt>Specifies which axis in the input counts contains the cells:</dt><dd><ul>
<li><p>0: cells are rows (shape: n_cells × n_genes)</p></li>
<li><p>1: cells are columns (shape: n_genes × n_cells)</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>ignore_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, excludes any samples containing NaN values from the entropy
calculation.</p></li>
<li><p><strong>temperature</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em><em>, </em><em>default=None</em>) – If provided, applies temperature scaling to the log-likelihoods
before computing entropy. Temperature scaling modifies the sharpness
of probability distributions by dividing log probabilities by a
temperature parameter T:</p></li>
<li><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Array of entropy values. Shape depends on return_by:</dt><dd><ul class="simple">
<li><p>If return_by=’cell’: shape is (n_samples, n_cells)</p></li>
<li><p>If return_by=’gene’: shape is (n_samples, n_genes)</p></li>
</ul>
</dd>
</dl>
<p>Higher values indicate more uncertainty in component assignments.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the model is not a mixture model or if posterior samples haven’t
    been generated.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This method requires posterior samples to be available. Call
get_posterior_samples() first if they haven’t been generated.</p></li>
<li><p>The entropy is computed using the full posterior predictive
distribution, accounting for uncertainty in the model parameters.</p></li>
<li><p>Normalization (normalize=True) is recommended when comparing entropy
across datasets or between cells/genes with different numbers of
observations.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.assignment_entropy_map">
<span class="sig-name descname"><span class="pre">assignment_entropy_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_by='gene'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_axis=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mean=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.assignment_entropy_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.assignment_entropy_map" title="Link to this definition"></a></dt>
<dd><p>Compute the entropy of component assignments for each cell evaluated at
the MAP.</p>
<p>This method calculates the entropy of the posterior component assignment
probabilities for each cell or gene, providing a measure of assignment
uncertainty. Higher entropy values indicate more uncertainty in the
component assignments, while lower values indicate more confident
assignments.</p>
<dl class="simple">
<dt>The entropy is calculated as:</dt><dd><p>H = -∑(p_i * log(p_i))</p>
</dd>
</dl>
<p>where p_i are the normalized probabilities for each component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> (<em>jnp.ndarray</em>) – The count matrix with shape (n_cells, n_genes).</p></li>
<li><p><strong>return_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default='gene'</em>) – Whether to return the entropy by cell or gene.</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>default=None</em>) – Size of mini-batches for likelihood computation</p></li>
<li><p><strong>cells_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – Axis along which cells are arranged. 0 means cells are rows.</p></li>
<li><p><strong>temperature</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em><em>, </em><em>default=None</em>) – If provided, applies temperature scaling to the log-likelihoods
before computing entropy.</p></li>
<li><p><strong>use_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – If True, uses the mean of the posterior component probabilities
instead of the MAP.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – If True, prints a warning if NaNs were replaced with means</p></li>
<li><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The component entropy for each cell evaluated at the MAP. Shape:
(n_cells,).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If the model is not a mixture model
    - If posterior samples have not been generated yet</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.hellinger_distance">
<span class="sig-name descname"><span class="pre">hellinger_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.hellinger_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.hellinger_distance" title="Link to this definition"></a></dt>
<dd><p>Compute pairwise Hellinger distances between mixture model components.</p>
<p>This method calculates the Hellinger distance between each pair of
components in the mixture model based on their inferred parameter
distributions. The Hellinger distance is a metric that quantifies the
similarity between two probability distributions, ranging from 0
(identical) to 1 (completely different).</p>
<p>The specific distance calculation depends on the distribution type used
for the dispersion parameter (r):</p>
<blockquote>
<div><ul class="simple">
<li><p>For LogNormal: Uses location and scale parameters</p></li>
<li><p>For Gamma: Uses concentration and rate parameters</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing pairwise Hellinger distances between
components. Keys are of the form ‘i_j’ where i,j are component
indices. Values are the Hellinger distances between components i and
j.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, jnp.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the model is not a mixture model with multiple components, or if
    the distribution type is not supported (must be LogNormal or Gamma)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.kl_divergence">
<span class="sig-name descname"><span class="pre">kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.kl_divergence" title="Link to this definition"></a></dt>
<dd><p>Compute pairwise KL divergences between mixture model components.</p>
<p>This method calculates the Kullback-Leibler (KL) divergence between each
pair of components in the mixture model based on their inferred
parameter distributions. The KL divergence is a measure of how one
probability distribution diverges from a second reference distribution,
with larger values indicating greater difference.</p>
<p>Note that KL divergence is asymmetric: KL(P||Q) ≠ KL(Q||P).</p>
<p>The specific divergence calculation depends on the distribution type
used for the dispersion parameter (r):</p>
<blockquote>
<div><ul class="simple">
<li><p>For LogNormal: Uses location and scale parameters</p></li>
<li><p>For Gamma: Uses concentration and rate parameters</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing pairwise KL divergences between components.
Keys are of the form ‘i_j’ where i,j are component indices. Values
are the KL divergences from component i to component j.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, jnp.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the model is not a mixture model with multiple components, or if
    the distribution type is not supported (must be LogNormal or Gamma)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.jensen_shannon_divergence">
<span class="sig-name descname"><span class="pre">jensen_shannon_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.jensen_shannon_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.jensen_shannon_divergence" title="Link to this definition"></a></dt>
<dd><p>Compute pairwise Jensen-Shannon divergences between mixture model
components.</p>
<p>This method calculates the Jensen-Shannon (JS) divergence between each
pair of components in the mixture model based on their inferred
parameter distributions. The JS divergence is a symmetrized and smoothed
version of the Kullback-Leibler divergence, defined as:</p>
<blockquote>
<div><p>JSD(P||Q) = 1/2 × KL(P||M) + 1/2 × KL(Q||M)</p>
</div></blockquote>
<p>where M = 1/2 × (P + Q) is the average of the two distributions.</p>
<p>Unlike KL divergence, JS divergence is symmetric and bounded between 0
and 1 (when using log base 2) or between 0 and ln(2) (when using natural
logarithm).</p>
<p>The specific divergence calculation depends on the distribution type
used for the dispersion parameter (r):</p>
<blockquote>
<div><ul class="simple">
<li><p>For LogNormal: Uses location and scale parameters</p></li>
<li><p>For Gamma: Uses concentration and rate parameters</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing pairwise JS divergences between components.
Keys are of the form ‘i_j’ where i,j are component indices. Values
are the JS divergences between components i and j.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, jnp.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the model is not a mixture model with multiple components, or if
    the distribution type is not supported (must be LogNormal or Gamma)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.cell_type_assignments">
<span class="sig-name descname"><span class="pre">cell_type_assignments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_axis=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_nans=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_distribution=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.cell_type_assignments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.cell_type_assignments" title="Link to this definition"></a></dt>
<dd><p>Compute probabilistic cell type assignments and fit Dirichlet
distributions to characterize assignment uncertainty.</p>
<dl class="simple">
<dt>For each cell, this method:</dt><dd><ol class="arabic simple">
<li><p>Computes component-specific log-likelihoods using posterior
samples</p></li>
<li><p>Converts these to probability distributions over cell types</p></li>
<li><p>Fits a Dirichlet distribution to characterize the uncertainty in
these assignments</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> (<em>jnp.ndarray</em>) – Count data to evaluate assignments for</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>default=None</em>) – Size of mini-batches for likelihood computation</p></li>
<li><p><strong>cells_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – Axis along which cells are arranged. 0 means cells are rows.</p></li>
<li><p><strong>ignore_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, removes any samples that contain NaNs.</p></li>
<li><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations</p></li>
<li><p><strong>fit_distribution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – If True, fits a Dirichlet distribution to the assignment
probabilities</p></li>
<li><p><strong>temperature</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em><em>, </em><em>default=None</em>) – If provided, apply temperature scaling to log probabilities</p></li>
<li><p><strong>weights</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em><em>, </em><em>default=None</em>) – Array used to weight genes when computing log likelihoods</p></li>
<li><p><strong>weight_type</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>default=None</em>) – <dl class="simple">
<dt>How to apply weights. Must be one of:</dt><dd><ul>
<li><p>’multiplicative’: multiply log probabilities by weights</p></li>
<li><p>’additive’: add weights to log probabilities</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – If True, prints progress messages</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Dictionary containing:</dt><dd><ul class="simple">
<li><p>’concentration’: Dirichlet concentration parameters for each
cell. Shape: (n_cells, n_components). Only returned if
fit_distribution is True.</p></li>
<li><p>’mean_probabilities’: Mean assignment probabilities for each
cell. Shape: (n_cells, n_components). Only returned if
fit_distribution is True.</p></li>
<li><p>’sample_probabilities’: Assignment probabilities for each
posterior sample. Shape: (n_samples, n_cells, n_components)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, jnp.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If the model is not a mixture model
    - If posterior samples have not been generated yet</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scribe.results.ScribeResults.cell_type_assignments_map">
<span class="sig-name descname"><span class="pre">cell_type_assignments_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_axis=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax.numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mean=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scribe/results.html#ScribeResults.cell_type_assignments_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scribe.results.ScribeResults.cell_type_assignments_map" title="Link to this definition"></a></dt>
<dd><p>Compute probabilistic cell type assignments using MAP estimates of
parameters.</p>
<dl class="simple">
<dt>For each cell, this method:</dt><dd><p>1. Computes component-specific log-likelihoods using MAP parameter
estimates
2. Converts these to probability distributions over cell types</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> (<em>jnp.ndarray</em>) – Count data to evaluate assignments for</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>default=None</em>) – Size of mini-batches for likelihood computation</p></li>
<li><p><strong>cells_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=0</em>) – Axis along which cells are arranged. 0 means cells are rows.</p></li>
<li><p><strong>dtype</strong> (<em>jnp.dtype</em><em>, </em><em>default=jnp.float32</em>) – Data type for numerical precision in computations</p></li>
<li><p><strong>temperature</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em><em>, </em><em>default=None</em>) – If provided, apply temperature scaling to log probabilities</p></li>
<li><p><strong>weights</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em><em>, </em><em>default=None</em>) – Array used to weight genes when computing log likelihoods</p></li>
<li><p><strong>weight_type</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>default=None</em>) – <dl class="simple">
<dt>How to apply weights. Must be one of:</dt><dd><ul>
<li><p>’multiplicative’: multiply log probabilities by weights</p></li>
<li><p>’additive’: add weights to log probabilities</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>use_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, replaces undefined MAP values (NaN) with posterior means</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – If True, prints progress messages</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>Dictionary containing:</dt><dd><ul class="simple">
<li><p>’probabilities’: Assignment probabilities for each cell.</p></li>
</ul>
<p>Shape: (n_cells, n_components)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, jnp.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the model is not a mixture model</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="svi.html" class="btn btn-neutral float-left" title="svi" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sampling.html" class="btn btn-neutral float-right" title="sampling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Manuel Razo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>